= Logging
:experimental:

Cider Log Mode allows you to capture, view and inspect log events
emitted by Java logging frameworks. The captured log events can be
searched, viewed in the Cider Inspector and Debugger and streamed to
clients.

image::cider-log.png[CIDER Log]

== Usage

To use Cider Log Mode, type kbd:[C-c l l] or kbd:[M-x cider-log] in
any buffer that has a Cider https://github.com/vspinu/sesman[Sesman]
session attached to it. The first time you run the command, it will
prompt you to select a log framework to use, and then attach a log
appender to the root logger of the selected framework. After the log
appender has been attached, the `cider-log` command will show a
https://www.gnu.org/software/emacs/manual/html_mono/transient.html[Transient]
menu, from which you can take further actions, like managing the log
framework, appenders, consumers and events.

To view log events and stream them to your client, type kbd:[es]
(Search log events) followed by kbd:[s]. This will open the
`+*cider-log*+` buffer showing any log events captured thus far. It will
also add a log consumer to this buffer, which receives newly-arriving
log events.

NOTE: The `+*cider-log*+` buffer might initially be empty, and you may
see a `No log events found.` message. This is because nothing has been
logged between adding the appender and searching for events. So, now
would be a good time to run some code that triggers a log event for
the selected framework.

=== Keybindings

|===
| Command | Keyboard shortcut | Description

| `cider-log`
| kbd:[C-c l l]
| Show the Cider log menu.

| `cider-log-appender`
| kbd:[C-c l a]
| Show the menu to manage appenders of a logging framework.

| `cider-log-consumer`
| kbd:[C-c l c]
| Show the menu to manage consumers listening to log events.

| `cider-log-event`
| kbd:[C-c l e]
| Show the menu to manage log events.
|===

== Log framework

=== Keybindings

|===
| Command | Keyboard shortcut | Description

| `cider-log-set-framework`
| kbd:[C-c l f s]
| Select the log framework to use.

| `cider-log-set-buffer`
| kbd:[C-c l f s]
| Select the log buffer to user. Default: `+*cider-log*+`

| `cider-log-framework-browse-javadoc`
| kbd:[C-c l f j]
| Browse the Javadocs of the log framework.

| `cider-log-framework-browse-website`
| kbd:[C-c l f w]
| Browse the website of the log framework.
|===

== Log Appender

A log appender can be attached to a logger of a log framework. Once
the appender is attached to a logger it captures the log events for
the

== Log Consumer


== Supported log frameworks

Cider Log Mode supports log frameworks that allow reconfiguration at
run time. More specifically the framework should support attaching log
appenders to loggers, in order to capture events.

At the moment the following log frameworks are supported:

- https://docs.oracle.com/en/java/javase/19/core/java-logging-overview.html[Java Util Logging]
- https://logback.qos.ch[Logback]

There is some work in progress to support
https://logging.apache.org/log4j/2.x/[Log4j] as well, but there are
some https://stackoverflow.com/a/17842174/12711900[difficulties] with
configuration changes made at runtime, which are wiped out by the
Log4j2's reconfiguration mechanism.
